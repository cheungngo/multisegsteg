% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/segmented.R
\name{plot_multi_segmented}
\alias{plot_multi_segmented}
\title{Plot the results of a multi-segmented regression model}
\usage{
plot_multi_segmented(
  result,
  data,
  formula.1,
  formula.2,
  plot.type = "both",
  n_points = 100,
  ...
)
}
\arguments{
\item{result}{List. Output from the multi_segmented function.}

\item{data}{Data frame. The original dataset used to fit the model.}

\item{formula.1}{Formula. The same formula.1 used in the multi_segmented function.}

\item{formula.2}{Formula. The same formula.2 used in the multi_segmented function.}

\item{plot.type}{Character. Type of plot to create:
- "both" (default): Creates both the fit plot and log-likelihood plot
- "fit": Creates only the fit plot with data points and fitted line
- "loglik": Creates only the log-likelihood plot}

\item{n_points}{Integer. Number of points to use for generating the smooth fitted line.
Higher values create a smoother curve. Default is 100.}

\item{...}{Additional arguments passed to ggplot functions.}
}
\value{
If plot.type = "both", returns a grid of plots arranged using gridExtra.
If plot.type = "fit" or "loglik", returns a single ggplot object.
}
\description{
Creates visualizations for interpreting multi-segmented regression models,
displaying both the fitted segmented line and the log-likelihood surface or profile.
For models with one threshold, the function shows a profile of log-likelihood values.
For models with two thresholds, it displays a heatmap of the log-likelihood surface.
}
\details{
This function generates two types of plots:
\enumerate{
\item \strong{Fit Plot}: Shows the original data points and the fitted segmented regression line,
with vertical dashed lines indicating the estimated threshold locations.
\item \strong{Log-likelihood Plot}:
\itemize{
\item For one threshold: Shows a profile of log-likelihood values across all candidate
threshold values, with the optimal threshold marked.
\item For two thresholds: Displays a heatmap of the log-likelihood surface across
all combinations of threshold values, with the optimal combination marked.
\item For more than two thresholds: Provides a text summary of the optimal thresholds
and their log-likelihood value.
}
}
}
\examples{
# Generate example data
set.seed(123)
n <- 200
x <- runif(n, 0, 10)
z <- rnorm(n)
y <- 1 + 0.5 * z + 0 * x + 1 * pmax(x - 3, 0) + 2 * pmax(x - 7, 0) + rnorm(n)
data <- data.frame(y = y, x = x, z = z)

# Fit model with two thresholds
result <- multi_segmented(
  formula.1 = y ~ z,
  formula.2 = ~ x,
  family = "gaussian",
  data = data,
  n_thresholds = 2
)

# Plot both the fitted line and log-likelihood surface
plot_multi_segmented(result, data, formula.1 = y ~ z, formula.2 = ~ x)

# Plot only the fitted line
fit_plot <- plot_multi_segmented(
  result, data,
  formula.1 = y ~ z,
  formula.2 = ~ x,
  plot.type = "fit"
)
print(fit_plot)

# Plot only the log-likelihood surface
loglik_plot <- plot_multi_segmented(
  result, data,
  formula.1 = y ~ z,
  formula.2 = ~ x,
  plot.type = "loglik"
)
print(loglik_plot)

}
\seealso{
\code{\link{multi_segmented}} for fitting the segmented regression model

\code{\link{plot_multi_stegmented}} for plotting step-segmented regression models
}
